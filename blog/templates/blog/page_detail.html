{% extends "blog/base.html" %}
{% load static %}

{% block title %}{{ page.title }} - Greg Dyche{% endblock %}

{% block description %}{{ page.content|striptags|truncatewords:25 }}{% endblock %}

{% block extra_css %}
{% if user.is_staff %}
<link rel="stylesheet" href="{% static 'blog/css/frontend-editor.css' %}">
{% endif %}
{% endblock %}

{% block extra_js %}
{% if user.is_staff %}
<script>
    window.isStaffUser = true;
    document.body.dataset.contentId = '{{ page.id }}';
    document.body.dataset.contentType = 'page';
</script>
<script src="{% static 'blog/js/frontend-editor.js' %}"></script>
{% endif %}
<script>
    // Set page slug data attribute for CSS targeting
    document.body.dataset.pageSlug = '{{ page.slug }}';
</script>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Hero Section for Landing Page -->
    {% if page.slug == "well-scripted-life-by-greg-dyche" %}
    <section class="hero" style="padding: 2rem 0 1rem 0; margin-bottom: 2rem;">
        <h1 class="hero-title" style="background: none !important; -webkit-background-clip: unset !important; -webkit-text-fill-color: #ffffff !important; color: #ffffff !important;">Well Scripted Life</h1>
    </section>
    {% endif %}
    
    <!-- Main Content Card -->
    <div class="grid grid-cols-1">
        <article class="card">
            <!-- Featured Image -->
            {% if page.get_featured_image_url and page.slug != "well-scripted-life-by-greg-dyche" %}
            <div class="featured-image-container" style="margin-bottom: 2rem;">
                <img src="{{ page.get_featured_image_url }}" alt="{{ page.title }}" 
                     style="width: 100%; height: 300px; object-fit: cover; border-radius: 8px;">
            </div>
            {% endif %}
            
            {% if page.slug != "well-scripted-life-by-greg-dyche" and not is_homepage %}
            <header class="card-header">
                <h1 class="card-title" data-editable="title">{{ page.title }}</h1>
                {% if page.published_date %}
                <p class="card-subtitle">Published {{ page.published_date|date:"F j, Y" }}</p>
                {% endif %}
            </header>
            {% endif %}
            
            <!-- Subscribe Button (not shown on homepage, coaching, or contact page) -->
            {% if not is_homepage and page.slug != "coaching" and page.slug != "contact" %}
            <div class="subscribe-cta">
                <div class="subscribe-cta-content">
                    <div class="subscribe-cta-text">
                        <h3>ðŸ“¬ Get updates when I publish new content</h3>
                        <p>Choose the topics you're interested in: Tech, Life Management, or Spiritual Growth</p>
                    </div>
                    <a href="/blog/subscribe/" class="subscribe-cta-button">
                        Subscribe Now
                    </a>
                </div>
            </div>
            {% endif %}
            
            
            <div class="card-content" data-editable="content">
                <!-- Display Django messages if any -->
                {% if messages %}
                <div style="margin-bottom: 2rem;">
                    {% for message in messages %}
                    <div style="padding: 1rem; border-radius: 6px; margin-bottom: 1rem; {% if message.tags == 'success' %}background: rgba(76, 175, 80, 0.1); border: 1px solid rgba(76, 175, 80, 0.3); color: #4CAF50;{% elif message.tags == 'error' %}background: rgba(244, 67, 54, 0.1); border: 1px solid rgba(244, 67, 54, 0.3); color: #F44336;{% endif %}">
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {{ page.content|safe }}
                
                <!-- Contact Form (show on coaching and contact pages) -->
                {% if page.slug == "coaching" or page.slug == "contact" %}
                <section style="margin-bottom: 4rem; background: rgba(255, 255, 255, 0.1); padding: 3rem 2rem; border-radius: 12px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        {% if page.slug == "coaching" %}
                        <h2 style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; text-align: center;">
                            Get Started
                        </h2>
                        <p style="color: var(--text-secondary); margin-bottom: 2rem; text-align: center;">
                            Tell me about your challenge or goal, and I'll get back to you within 24 hours.
                        </p>
                        {% else %}
                        <h2 style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; text-align: center;">
                            Send Me a Message
                        </h2>
                        <p style="color: var(--text-secondary); margin-bottom: 2rem; text-align: center;">
                            I'd love to hear from you! Drop me a line and I'll get back to you soon.
                        </p>
                        {% endif %}
                        
                        <form method="post" action="/blog/coaching-inquiry/" style="display: grid; gap: 1.5rem;">
                            {% csrf_token %}
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">Name</label>
                                    <input type="text" name="name" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">Email</label>
                                    <input type="email" name="email" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-primary);">
                                </div>
                            </div>
                            
                            <div>
                                {% if page.slug == "coaching" %}
                                <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">I'm interested in:</label>
                                <select name="interest" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-primary);">
                                    <option value="private">Private Session</option>
                                    <option value="business">Business Lunch & Learn</option>
                                    <option value="custom">Something Custom</option>
                                    <option value="exploring">Just Exploring</option>
                                </select>
                                {% else %}
                                <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">What would you like to talk about?</label>
                                <select name="interest" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-primary);">
                                    <option value="ai">AI & Technology</option>
                                    <option value="python">Python Development</option>
                                    <option value="education">Educational Technology</option>
                                    <option value="productivity">Productivity Systems</option>
                                    <option value="career">Career & Tech Transitions</option>
                                    <option value="faith">Faith & Intentional Living</option>
                                    <option value="other">Something Else</option>
                                </select>
                                {% endif %}
                            </div>
                            
                            <div>
                                {% if page.slug == "coaching" %}
                                <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">Tell me about your challenge or goal:</label>
                                {% else %}
                                <label style="display: block; color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">Your message:</label>
                                {% endif %}
                                <textarea name="message" rows="4" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; background: rgba(255,255,255,0.1); color: var(--text-primary); resize: vertical;"></textarea>
                            </div>
                            
                            <button type="submit" style="background: var(--spirit-accent); color: var(--creighton-navy); padding: 1rem 2rem; border: none; border-radius: 6px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all 0.2s ease;">
                                Send Message
                            </button>
                        </form>
                        
                        <p style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-muted);">
                            Or email me directly: <a href="mailto:gregdyche@gmail.com?subject=Coaching Inquiry" style="color: var(--spirit-accent);">gregdyche@gmail.com</a>
                        </p>
                    </div>
                </section>
                {% endif %}
            </div>
        </article>
    </div>
    
    <!-- Blog Sections Navigation -->
    {% if page.slug == "well-scripted-life-by-greg-dyche" %}
    <section class="mt-12">
        <h2 class="text-center mb-8" style="font-size: 2rem; font-weight: 700; color: var(--text-primary);">Explore the Blog</h2>
        <div class="grid grid-cols-3">
            <a href="/blog/tech/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">Technology Blog</h3>
                    <p class="card-subtitle">Code, Tools & Innovation</p>
                </div>
                <p class="card-content">Python development, AI/ML insights, development workflows, and emerging technologies.</p>
            </a>
            
            <a href="/blog/life/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">Life Management</h3>
                    <p class="card-subtitle">Systems & Productivity</p>
                </div>
                <p class="card-content">Personal workflows, productivity systems, education insights, and life optimization.</p>
            </a>
            
            <a href="/blog/spirit/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">Spiritual Growth</h3>
                    <p class="card-subtitle">Faith & Reflection</p>
                </div>
                <p class="card-content">Thoughts on faith, intentional living, and finding meaning in daily life.</p>
            </a>
        </div>
    </section>
    
    <section class="mt-12">
        <h2 class="text-center mb-8" style="font-size: 2rem; font-weight: 700; color: var(--text-primary);">Quick Access</h2>
        <div class="grid grid-cols-3">
            <a href="/blog/page/downloads/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">Downloads</h3>
                    <p class="card-subtitle">Resources & Tools</p>
                </div>
                <p class="card-content">Access presentations, workbooks, and educational materials.</p>
            </a>
            
            <a href="/blog/page/tech-stack/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">Tech Stack</h3>
                    <p class="card-subtitle">Tools & Setup</p>
                </div>
                <p class="card-content">My development environment, favorite tools, and technical workflows.</p>
            </a>
            
            <a href="/blog/page/about/" class="card card-clickable">
                <div class="card-header">
                    <h3 class="card-title">About Greg</h3>
                    <p class="card-subtitle">Background & Philosophy</p>
                </div>
                <p class="card-content">Learn about my background in education, technology, and life philosophy.</p>
            </a>
        </div>
    </section>
    {% endif %}
</div>
{% endblock %}
